(function(){function process_data(){get_lines_intersections_data(),get_ipoints_data()}function get_lines_intersections_data(){for(var a=1;stations[a];a++){var b=stations[a],c=b.lines;if(c.length>1)for(var d=0;c[d];d++)for(var e=c[d],f=d+1;c[f];f++){var g=c[f];lines[e].intersections[g]=a,lines[g].intersections[e]=a}}}function get_ipoints_data(){for(var a=1;stations[a];a++){var b=stations[a],c=b.lines;if(c.length>1)for(var d=0;c[d];d++){var e=c[d];ipoints[e].push(a)}}}function find_route(a,b){possible_routes=[],memo=[],get_routes(a,b);var c=[];possible_routes.copyTo(c),render_multiple(c)}function get_routes(a,b){var c=same_line(a,b),d={stations_count:0,interchanges_count:0,directions:[]};if(c)d.stations_count=c.count,d.interchanges_count=0,d.directions[0]=c,possible_routes.push(d);else{var e=direct_intersection(a,b);if(e){var f=count_total_stations(e);d.stations_count=f,d.interchanges_count=1,e.copyTo(d.directions),possible_routes.push(d)}else for(var g=get_station_lines(a),h=0;g[h];h++)for(var i=g[h],j=get_ipoints(i,a),k=0;j[k];k++){var l=j[k];if(!memo.hasElement(l)){d.directions.empty(),d.directions.push({count:get_stations_count(a,l,i),direc:{from:a,to:l,line:i}}),memo.push(l);for(var m=find_multiple_intersections(l,b,i),n=0;m.directions[n];n++)d.directions.push(m.directions[n]);merge_simult_dirns_on_same_line(d.directions),d.stations_count=count_total_stations(d.directions),d.interchanges_count=d.directions.length-1;var o={stations_count:0,interchanges_count:0,directions:[]};o.stations_count=d.stations_count,o.interchanges_count=d.interchanges_count,d.directions.copyTo(o.directions),m.count>0&&possible_routes.push(o)}}}}function find_multiple_intersections(a,b,c){var d=[],e=1e3,f=direct_intersection(a,b);if(d.empty(),f)for(var g=0;f[g];g++)d.push(f[g]);else for(var h=get_station_lines(a),i=0;h[i];i++){var j=h[i],k=get_ipoints(j,a);if(j!=c)for(var l=0;k[l];l++){var m=k[l];if(!memo.hasElement(m)){memo.push(m);var n=find_multiple_intersections(m,b,j);if(n.count<e&&n.count>0){d.empty(),d.push({count:get_stations_count(a,m,j),direc:{from:a,to:m,line:j}});for(var o=0;n.directions[o];o++)d.push(n.directions[o]);e=n.count}}}}return merge_simult_dirns_on_same_line(d),{count:count_total_stations(d),directions:d}}function same_line(a,b){var c=get_station_lines(a),d=get_station_lines(b),e=commonElementInArrays(c,d);if(e){var f=get_stations_count(a,b,e);return{count:f,direc:{from:a,to:b,line:e}}}return!1}function direct_intersection(a,b){for(var c=get_station_lines(a),d=get_station_lines(b),e=[],f=0;c[f];f++)for(var g=c[f],h=0;d[h];h++){var i=d[h];if(lines[g].intersections[i]){var j=lines[g].intersections[i],k=same_line(a,j),l=same_line(j,b);return e.push(k,l),e}}return!1}function get_station_name(a){return stations[a].name}function get_station_lines(a){return stations[a].lines}function get_line_name(a){return lines[a].name}function get_line_details(a){var b=lines[a].stations[0],c=lines[a].stations[lines[a].stations.length-1];return[get_station_name(b),"-",get_station_name(c)].j()}function get_ipoints(a,b){var c=[];ipoints[a].copyTo(c);for(var d=0;c[d];d++)c[d]&&(c[d]==b||memo.hasElement(c[d]))&&(c.splice(d,1),d--);return c}function _(a){return document.querySelector(a)}function commonElementInArrays(a,b){for(var c=0;a[c];c++)if(b.hasElement(a[c]))return a[c];return!1}function firstWordsCap(a){for(var b=a.split(" "),c="",d=0;b[d];d++)c+=a.replace(b[d][0],b[d][0].toUpperCase());return c}function stripNos(a){return a.replace(/[0-9]/g,"")}function isIPoint(a){Object.keys(ipoints)}function get_towards(a,b,c){var d,e=lines[c].stations;return d=e.indexOf(a)<e.indexOf(b)?e[e.length-1]:e[0]}function get_stations_count(a,b,c){return stations[a].lines.hasElement(c)&&stations[b].lines.hasElement(c)?Math.abs(lines[c].stations.indexOf(a)-lines[c].stations.indexOf(b)):!1}function count_total_stations(a){for(var b=0,c=0;a[c];c++)b+=a[c].count;return b}function merge_simult_dirns_on_same_line(a){for(var b=0,c=a.length-1;c>b;b++)a[b].direc.line==a[b+1].direc.line&&(a[b].direc.to=a[b+1].direc.to,a[b].count+=a[b+1].count,a.splice(b+1,1),c=a.length-1,b--)}function markupSelects(){for(var a,b=Object.keys(stations).length,c=1;b>=c;c++)a=document.createElement("option"),$(a).html(get_station_name(c)),$(a).attr("value",c),$("#boarding").append($(a));for(c=1;b>=c;c++)a=document.createElement("option"),$(a).html(get_station_name(c)),$(a).attr("value",c),$("#deboarding").append($(a))}function render_multiple(a){for(var b=[],c=0;a[c];c++)b.push([a[c].stations_count,"-",a[c].interchanges_count].j());b.sort(),$(".options").html(["<h3>",c," route",1==c?"":"s"," found</h3>"].j());for(var d=0;b[d];d++)for(var e=b[d].split("-"),f=Math.abs(e[0]),g=Math.abs(e[1]),h=0;a[h];h++)if(a[h].stations_count==f&&a[h].interchanges_count==g){var i=a[h].stations_count,j=a[h].directions,k=a[h].interchanges_count;$(".options").append("<h4 id='sc'>"+i+" stations, "+k+" interchange"+(1==k?"":"s")+"</h4>");for(var l=0;j[l];l++){var m=document.createElement("p");$(m).addClass("bg-success "+j[l].direc.line.replace(/\d+/g,"")),$(m).html("<b>Step "+(l+1)+"</b>: "+gen_text(j[l].direc)),$(".options").append($(m))}$(".options").append("<hr/>"),a.splice(h,1);break}}function gen_text(a){var b=get_station_name(a.from),c=get_station_name(a.to),d=get_line_name(a.line),e=get_station_name(get_towards(a.from,a.to,a.line)),f=get_line_details(a.line);return["Board the <b>",d,"</b> line train (",f,") from ",b," towards <b>",e,"</b> and deboard at <b>",c,"</b>."].j()}var stations={1:{name:"Rithala",lines:["red"]},2:{name:"Rohini West",lines:["red"]},3:{name:"Rohini East",lines:["red"]},4:{name:"Pitampura",lines:["red"]},5:{name:"Kohat Enclave",lines:["red"]},6:{name:"NSP",lines:["red"]},7:{name:"Keshav Puram",lines:["red"]},8:{name:"Kanhaiya Nagar",lines:["red"]},9:{name:"Inderlok",lines:["red","green"]},10:{name:"Shastri Nagar",lines:["red"]},11:{name:"Pratap Nagar",lines:["red"]},12:{name:"Pulbangash",lines:["red"]},13:{name:"Tis Hazari",lines:["red"]},14:{name:"Kashmere Gate",lines:["red","yellow"]},15:{name:"Shastri Park",lines:["red"]},16:{name:"Seelampur",lines:["red"]},17:{name:"Welcome",lines:["red"]},18:{name:"Shahdara",lines:["red"]},19:{name:"Mansarovar Park",lines:["red"]},20:{name:"Jhilmil",lines:["red"]},21:{name:"Dilshad Garden",lines:["red"]},22:{name:"Jahangirpuri",lines:["yellow"]},23:{name:"Adarsh Nagar",lines:["yellow"]},24:{name:"Azadpur",lines:["yellow"]},25:{name:"Model Town",lines:["yellow"]},26:{name:"GTB Nagar",lines:["yellow"]},27:{name:"Vishwavidyalaya",lines:["yellow"]},28:{name:"Vidhan Sabha",lines:["yellow"]},29:{name:"Civil Lines",lines:["yellow"]},30:{name:"Chandni Chowk",lines:["yellow"]},31:{name:"Chawri Bazar",lines:["yellow"]},32:{name:"New Delhi",lines:["yellow","airport"]},33:{name:"Rajiv Chowk",lines:["yellow","blue"]},34:{name:"Patel Chowk",lines:["yellow"]},35:{name:"Central Secretariat",lines:["yellow","violet"]},36:{name:"Udyog Bhawan",lines:["yellow"]},37:{name:"Race Course",lines:["yellow"]},38:{name:"Jor Bagh",lines:["yellow"]},39:{name:"INA",lines:["yellow"]},40:{name:"AIIMS",lines:["yellow"]},41:{name:"Green Park",lines:["yellow"]},42:{name:"Hauz Khaz Enclave",lines:["yellow"]},43:{name:"Malvaiya Nagar",lines:["yellow"]},44:{name:"Saket",lines:["yellow"]},45:{name:"Qutab Minar",lines:["yellow"]},46:{name:"Chhatarpur",lines:["yellow"]},47:{name:"Sultanpur",lines:["yellow"]},48:{name:"Ghitorni",lines:["yellow"]},49:{name:"Arjangarh",lines:["yellow"]},50:{name:"Guru Dhronacharya",lines:["yellow"]},51:{name:"Sikandarpur",lines:["yellow"]},52:{name:"MG Road",lines:["yellow"]},53:{name:"IFFCO Chowk",lines:["yellow"]},54:{name:"Huda City Centre",lines:["yellow"]},55:{name:"Mandi House",lines:["violet","blue"]},56:{name:"Janpath",lines:["violet"]},57:{name:"Khan Market",lines:["violet"]},58:{name:"JLN Stadium",lines:["violet"]},59:{name:"Jangpura",lines:["violet"]},60:{name:"Lajpat Nagar",lines:["violet"]},61:{name:"Moolchand",lines:["violet"]},62:{name:"Kailash Colony",lines:["violet"]},63:{name:"Nehru Place",lines:["violet"]},64:{name:"Kalkaji Mandir",lines:["violet"]},65:{name:"Govindpuri",lines:["violet"]},66:{name:"Okhla",lines:["violet"]},67:{name:"Jasola",lines:["violet"]},68:{name:"Sarita Vihar",lines:["violet"]},69:{name:"Mohan Estate",lines:["violet"]},70:{name:"Tughlakabad",lines:["violet"]},71:{name:"Badarpur",lines:["violet"]},72:{name:"Ashok Park Main",lines:["green","green2"]},73:{name:"Satguru Ram Singh Marg",lines:["green2"]},74:{name:"Kirti Nagar",lines:["green2","blue"]},75:{name:"Punjabi Bagh",lines:["green"]},76:{name:"Shivaji Park",lines:["green"]},77:{name:"Madipur",lines:["green"]},78:{name:"Paschim Vihar",lines:["green"]},79:{name:"Sehdev Park",lines:["green"]},80:{name:"Peera Garhi",lines:["green"]},81:{name:"Udyog Nagar",lines:["green"]},82:{name:"Surajmal Stadium",lines:["green"]},83:{name:"Nangloi",lines:["green"]},84:{name:"Nangloi Railway Station",lines:["green"]},85:{name:"Rajdhani Park",lines:["green"]},86:{name:"Mundka",lines:["green"]},87:{name:"Noida City Centre",lines:["blue"]},88:{name:"Golf Course",lines:["blue"]},89:{name:"Botanical Gardens",lines:["blue"]},90:{name:"Noida Sec. 18",lines:["blue"]},91:{name:"Noida Sec. 16",lines:["blue"]},92:{name:"Noida Sec. 15",lines:["blue"]},93:{name:"New Ashok Nagar",lines:["blue"]},94:{name:"Mayur Vihar-1 Ext.",lines:["blue"]},95:{name:"Mayur Vihar-1",lines:["blue"]},96:{name:"Akshardham",lines:["blue"]},97:{name:"Yamuna Bank",lines:["blue","blue2"]},98:{name:"Indraprastha",lines:["blue"]},99:{name:"Pragati Maidan",lines:["blue"]},100:{name:"Barakhamba Road",lines:["blue"]},101:{name:"RK Ashram Marg",lines:["blue"]},102:{name:"Jhandewalan",lines:["blue"]},103:{name:"Karol Bagh",lines:["blue"]},104:{name:"Rajendra Place",lines:["blue"]},105:{name:"Patel Nagar",lines:["blue"]},106:{name:"Shadipur",lines:["blue"]},107:{name:"Moti Nagar",lines:["blue"]},108:{name:"Ramesh Nagar",lines:["blue"]},109:{name:"Rajouri Garden",lines:["blue"]},110:{name:"Tagore Garden",lines:["blue"]},111:{name:"Subhash Nagar",lines:["blue"]},112:{name:"Tilak Nagar",lines:["blue"]},113:{name:"Janakpuri East",lines:["blue"]},114:{name:"Janakpuri West",lines:["blue"]},115:{name:"Uttam Nagar East",lines:["blue"]},116:{name:"Uttam Nagar West",lines:["blue"]},117:{name:"Nawada",lines:["blue"]},118:{name:"Dwarka Mor",lines:["blue"]},119:{name:"Dwarka",lines:["blue","blue3"]},120:{name:"Dwarka Sector 14",lines:["blue"]},121:{name:"Dwarka Sector 13",lines:["blue"]},122:{name:"Dwarka Sector 12",lines:["blue"]},123:{name:"Dwarka Sector 11",lines:["blue"]},124:{name:"Dwarka Sector 10",lines:["blue"]},125:{name:"Dwarka Sector 9",lines:["blue"]},126:{name:"Dwarka Sector 21",lines:["blue","airport"]},127:{name:"Najafgarh Metro Depot",lines:["blue3"]},128:{name:"Laxmi Nagar",lines:["blue2"]},129:{name:"Nirman Vihar",lines:["blue2"]},130:{name:"Preet Vihar",lines:["blue2"]},131:{name:"Karkarduma",lines:["blue2"]},132:{name:"Anand Vihar ISBT",lines:["blue2"]},133:{name:"Kaushambi",lines:["blue2"]},134:{name:"KB Vaishali",lines:["blue2"]},135:{name:"Shivaji Stadium",lines:["airport"]},136:{name:"Dhaula Khan",lines:["airport"]},137:{name:"Delhi Aerocity",lines:["airport"]},138:{name:"IGD Airport",lines:["airport"]},139:{name:"IGI Airport",lines:["airport"]},140:{name:"ITO",lines:["violet"]}},lines={red:{name:"Red",stations:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],intersections:{}},green:{name:"Green",stations:[9,72,75,76,77,78,79,80,81,82,83,84,85,86],intersections:{}},green2:{name:"Green",stations:[9,72,73,74],intersections:{}},yellow:{name:"Yellow",stations:[22,23,24,25,26,27,28,29,14,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],intersections:{}},blue:{name:"Blue",stations:[87,88,89,90,91,92,93,94,95,96,97,98,99,55,100,33,102,103,104,105,106,74,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126],intersections:{}},blue2:{name:"Blue",stations:[97,128,129,130,131,132,133,134],intersections:{}},blue3:{name:"Blue",stations:[119,127],intersections:{}},violet:{name:"Violet",stations:[140,55,56,35,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71],intersections:{}},airport:{name:"Airport Express",stations:[32,135,136,137,138,139,126],intersections:{}}},ipoints={red:[],yellow:[],green:[],green2:[],violet:[],airport:[],blue:[],blue2:[],blue3:[]},possible_routes,memo;Array.prototype.hasElement=function(a){return-1==this.indexOf(a)?!1:!0},Array.prototype.empty=function(){return this.splice(0,this.length),this},Array.prototype.j=function(){return this.join("")},Array.prototype.copyTo=function(a){for(var b=0;this[b];b++)a.push(this[b])},$(document).ready(function(){process_data(),markupSelects(),$("#boarding").select2(),$("#deboarding").select2(),$("#boarding").select2(),$("#deboarding").select2(),$("#searchRoute").click(function(){var a=$("#boarding").val(),b=$("#deboarding").val();find_route(Math.abs(a),Math.abs(b))})});})();